<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="//cdn.datatables.net/2.3.4/css/dataTables.dataTables.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="//cdn.datatables.net/2.3.4/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.3.4/js/dataTables.js"></script>
  </head>
  <body>
    <!-- <button onclick="postRequest()">Post요청</button> -->
    <table id="example" class="display" width="100%"></table>
    <script>
      let url = //perpage : 한페이지에 몇개씩 보여줄지
        "https://api.odcloud.kr/api/15077586/v1/centers?page=1&perPage=284&serviceKey=9a34b85611a37fd6ae943f38184d77fa4a5699e47252cc9c8d8fba22e29a1779";
      // 요청방식 + resource(url) => crud(create read update delete) = Rest API

      //get 방식. http://localhost:3000/posts 젠체글 조회. http://localhost:3000/posts/1 상세글 -> header영역으로 제한적 정보
      fetch(url) // 프로미스 객체를 then이라는 메소드에 전달
        .then((resp) => resp.json()) // body의 값을 읽게하는 함수 stream -> javascript 객체.
        .then((result) => {
          const totalList = result.data; // [{},{},{},{},{},{},{},] => [[],[],[],[],[],[],[],]
          const data = [];
          for (let center of totalList) {
            data.push([
              center.id,
              center.centerName,
              center.phoneNumber,
              center.address,
              center.sido,
            ]);
          }
          console.log(data);
          new DataTable("#example", {
            columns: [
              { title: "센터ID" },
              { title: "센터명" },
              { title: "전화번호" },
              { title: "주소" },
              { title: "시도구분" },
            ],
            data: data,
          });
        });
      //post 방식. http://localhost:3000/posts 등록. -> body 영역으로 많은 양의 정보 전달 가능

      function postRequest() {
        // const data = { id: 3, title: "sample data", author: "user01" };
        const data = { title: "sample data", author: "user01" };
        // post 요청.
        fetch("http://localhost:3000/posts", {
          method: "post", // put방식은 put
          headers: { "Content-Type": "applicaton/json" },
          body: JSON.stringify(data),
        })
          .then(function (resp) {
            return resp.json();
          })
          .then(function (result) {
            console.log(result);
          })
          .catch(function (err) {
            console.log(err);
          });
      }

      // //put방식. 수정
      // function postRequest() {
      //   const data = { id: 3, title: "data sample", author: "user01" };
      //   // put 요청. 대상 존재 필수
      //   fetch("http://localhost:3000/posts/3", {
      //     method: "put", // put방식은 put
      //     headers: { "Content-Type": "applicaton/json" },
      //     body: JSON.stringify(data),
      //   })
      //     .then(function (resp) {
      //       return resp.json();
      //     })
      //     .then(function (result) {
      //       console.log(result);
      //     })
      //     .catch(function (err) {
      //       console.log(err);
      //     });
      // }

      // //delete방식. 삭제
      // function postRequest() {
      //   const data = { id: 3, title: "data sample", author: "user01" };
      //   // delet 요청. 대상 존재 필수
      //   fetch("http://localhost:3000/posts/4", {
      //     method: "delete", // put방식은 put
      //     headers: { "Content-Type": "applicaton/json" },
      //     body: JSON.stringify(data),
      //   })
      //     .then(function (resp) {
      //       return resp.json();
      //     })
      //     .then(function (result) {
      //       console.log(result);
      //     })
      //     .catch(function (err) {
      //       // 오류 잡는 함수
      //       console.log(err);
      //     });
      // }
    </script>
  </body>
</html>
